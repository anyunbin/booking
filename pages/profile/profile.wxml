<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <!-- 用户信息卡片 -->
  <view class="user-card">
    <view class="avatar-section">
      <image class="avatar" src="{{userInfo.avatar_url || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-info">
        <view class="nickname">{{userInfo.nickname || userInfo.name || '未设置'}}</view>
        <view class="username">@{{userInfo.username}}</view>
      </view>
    </view>
  </view>

  <!-- 功能列表 -->
  <view class="menu-list">
    <view class="menu-item" bindtap="editProfile">
      <view class="menu-icon">👤</view>
      <view class="menu-content">
        <view class="menu-title">个人信息</view>
        <view class="menu-desc">修改昵称、头像等</view>
      </view>
      <view class="menu-arrow">›</view>
    </view>

    <view class="menu-item" bindtap="changePassword">
      <view class="menu-icon">🔒</view>
      <view class="menu-content">
        <view class="menu-title">修改密码</view>
        <view class="menu-desc">更改登录密码</view>
      </view>
      <view class="menu-arrow">›</view>
    </view>

    <view class="menu-item" bindtap="logout">
      <view class="menu-icon">🚪</view>
      <view class="menu-content">
        <view class="menu-title">退出登录</view>
      </view>
      <view class="menu-arrow">›</view>
    </view>
  </view>
</view>

<!-- 修改个人信息弹窗 -->
<view class="modal" wx:if="{{showEditModal}}" bindtap="closeEditModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-title">修改个人信息</view>
    <view class="form-group">
      <view class="label">昵称</view>
      <input class="input" type="text" placeholder="请输入昵称" value="{{editNickname}}" bindinput="onEditNicknameInput" />
    </view>
    <view class="form-group">
      <view class="label">姓名</view>
      <input class="input" type="text" placeholder="请输入姓名" value="{{editName}}" bindinput="onEditNameInput" />
    </view>
    <view class="form-group">
      <view class="label">手机号</view>
      <input class="input" type="number" placeholder="请输入手机号" value="{{editPhone}}" bindinput="onEditPhoneInput" />
    </view>
    <view class="form-group">
      <view class="label">邮箱</view>
      <input class="input" type="text" placeholder="请输入邮箱" value="{{editEmail}}" bindinput="onEditEmailInput" />
    </view>
    <view class="modal-buttons">
      <button class="btn-cancel" bindtap="closeEditModal">取消</button>
      <button class="btn-confirm" bindtap="confirmEditProfile" loading="{{isSubmitting}}">保存</button>
    </view>
  </view>
</view>

<!-- 修改密码弹窗 -->
<view class="modal" wx:if="{{showPasswordModal}}" bindtap="closePasswordModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-title">修改密码</view>
    <view class="form-group">
      <view class="label">当前密码</view>
      <input class="input" type="password" placeholder="请输入当前密码" value="{{oldPassword}}" bindinput="onOldPasswordInput" />
    </view>
    <view class="form-group">
      <view class="label">新密码</view>
      <input class="input" type="password" placeholder="请输入新密码（至少6个字符）" value="{{newPassword}}" bindinput="onNewPasswordInput" />
    </view>
    <view class="form-group">
      <view class="label">确认新密码</view>
      <input class="input" type="password" placeholder="请再次输入新密码" value="{{confirmPassword}}" bindinput="onConfirmPasswordInput" />
    </view>
    <view class="modal-buttons">
      <button class="btn-cancel" bindtap="closePasswordModal">取消</button>
      <button class="btn-confirm" bindtap="confirmChangePassword" loading="{{isSubmitting}}">确认修改</button>
    </view>
  </view>
</view>

